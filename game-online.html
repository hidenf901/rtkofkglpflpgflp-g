<!DOCTYPE html>
<html>
<head>
    <title>–ò–≥—Ä–∞ –æ–Ω–ª–∞–π–Ω</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 15px;
        }
        
        .game {
            background: white;
            padding: 30px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 100%;
        }
        
        .players {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 15px;
        }
        
        .player {
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 10px;
        }
        
        .player.x {
            background: #ff6b6b;
            color: white;
        }
        
        .player.o {
            background: #4ecdc4;
            color: white;
        }
        
        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            background: #667eea;
            padding: 10px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .cell {
            aspect-ratio: 1;
            background: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 0 #4a5fd0;
        }
        
        .cell:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .message {
            font-size: 1.5em;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 15px;
            font-weight: bold;
        }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.2em;
            cursor: pointer;
            margin: 5px;
        }
        
        .vip-feature {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #fff9e6, #fff3cd);
            border-radius: 15px;
            border: 2px solid #FFD700;
        }
    </style>
</head>
<body>
    <div class="game">
        <h2>‚öîÔ∏è –ò–≥—Ä–∞ –æ–Ω–ª–∞–π–Ω ‚öîÔ∏è</h2>
        
        <div class="players">
            <div class="player x" id="playerX">X: –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div class="player o" id="playerO">O: –ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        
        <div class="board" id="board">
            <div class="cell" onclick="makeMove(0)" id="cell0" disabled></div>
            <div class="cell" onclick="makeMove(1)" id="cell1" disabled></div>
            <div class="cell" onclick="makeMove(2)" id="cell2" disabled></div>
            <div class="cell" onclick="makeMove(3)" id="cell3" disabled></div>
            <div class="cell" onclick="makeMove(4)" id="cell4" disabled></div>
            <div class="cell" onclick="makeMove(5)" id="cell5" disabled></div>
            <div class="cell" onclick="makeMove(6)" id="cell6" disabled></div>
            <div class="cell" onclick="makeMove(7)" id="cell7" disabled></div>
            <div class="cell" onclick="makeMove(8)" id="cell8" disabled></div>
        </div>
        
        <div class="message" id="message">–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞...</div>
        
        <button onclick="window.location.href='lobby.html'">‚¨ÖÔ∏è –í –ª–æ–±–±–∏</button>
        
        <!-- VIP —Ñ—É–Ω–∫—Ü–∏–∏ -->
        <div id="vipFeatures" class="vip-feature" style="display: none;">
            ‚≠ê VIP —Ä–µ–∂–∏–º: —Å–∫–∏–Ω—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
        </div>
    </div>

    <script>
        const playerName = localStorage.getItem('playerName') || '–ò–≥—Ä–æ–∫';
        const playerVersion = localStorage.getItem('playerVersion') || 'free';
        const opponent = localStorage.getItem('opponent') || '–°–æ–ø–µ—Ä–Ω–∏–∫';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º VIP —Ñ—É–Ω–∫—Ü–∏–∏
        if (playerVersion === 'vip') {
            document.getElementById('vipFeatures').style.display = 'block';
        }
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤
        document.getElementById('playerX').textContent = `X: ${playerName}`;
        document.getElementById('playerO').textContent = `O: ${opponent}`;
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let board = ['', '', '', '', '', '', '', '', ''];
        let currentPlayer = 'X';
        let gameActive = true;
        let myTurn = true; // –¢–µ–∫—É—â–∏–π –∏–≥—Ä–æ–∫ —Ö–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–º
        
        function enableBoard() {
            for (let i = 0; i < 9; i++) {
                document.getElementById(`cell${i}`).disabled = false;
            }
        }
        
        function makeMove(index) {
            if (!gameActive || !myTurn) return;
            
            const cell = document.getElementById(`cell${index}`);
            
            if (board[index] === '') {
                board[index] = currentPlayer;
                cell.textContent = currentPlayer;
                cell.disabled = true;
                
                if (checkWin()) {
                    gameActive = false;
                    document.getElementById('message').textContent = `${currentPlayer} –ø–æ–±–µ–¥–∏–ª! üéâ`;
                    disableBoard();
                } else if (board.every(cell => cell !== '')) {
                    gameActive = false;
                    document.getElementById('message').textContent = '–ù–∏—á—å—è! ü§ù';
                } else {
                    currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
                    myTurn = false;
                    document.getElementById('message').textContent = `–•–æ–¥ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ (${currentPlayer})`;
                    
                    // –ò–º–∏—Ç–∞—Ü–∏—è —Ö–æ–¥–∞ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        if (gameActive) {
                            makeAIMove();
                        }
                    }, 2000);
                }
            }
        }
        
        function makeAIMove() {
            // –ü—Ä–æ—Å—Ç–æ–π AI –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            const emptyCells = board.reduce((acc, cell, index) => {
                if (cell === '') acc.push(index);
                return acc;
            }, []);
            
            if (emptyCells.length > 0 && gameActive) {
                const randomIndex = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                const cell = document.getElementById(`cell${randomIndex}`);
                
                board[randomIndex] = currentPlayer;
                cell.textContent = currentPlayer;
                cell.disabled = true;
                
                if (checkWin()) {
                    gameActive = false;
                    document.getElementById('message').textContent = `${currentPlayer} –ø–æ–±–µ–¥–∏–ª! üéâ`;
                    disableBoard();
                } else if (board.every(cell => cell !== '')) {
                    gameActive = false;
                    document.getElementById('message').textContent = '–ù–∏—á—å—è! ü§ù';
                } else {
                    currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
                    myTurn = true;
                    document.getElementById('message').textContent = `–¢–≤–æ–π —Ö–æ–¥ (${currentPlayer})`;
                }
            }
        }
        
        function checkWin() {
            const lines = [
                [0,1,2], [3,4,5], [6,7,8],
                [0,3,6], [1,4,7], [2,5,8],
                [0,4,8], [2,4,6]
            ];
            
            for (let line of lines) {
                if (board[line[0]] && 
                    board[line[0]] === board[line[1]] && 
                    board[line[0]] === board[line[2]]) {
                    return true;
                }
            }
            return false;
        }
        
        function disableBoard() {
            for (let i = 0; i < 9; i++) {
                document.getElementById(`cell${i}`).disabled = true;
            }
        }
        
        // –ù–∞—á–∏–Ω–∞–µ–º –∏–≥—Ä—É
        setTimeout(() => {
            document.getElementById('message').textContent = `–¢–≤–æ–π —Ö–æ–¥ (X)`;
            enableBoard();
        }, 1000);
    </script>
</body>
</html>